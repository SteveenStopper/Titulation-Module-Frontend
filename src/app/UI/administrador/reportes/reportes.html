<div class="space-y-6">
  <!-- Cabecera de impresión (se mostrará en PDF y también se inyectará en nueva ventana) -->
  <div class="hidden print:block" #printHeader>
    <div class="text-center">
      <div class="text-lg font-semibold">Reporte del Administrador</div>
      <div class="text-xs text-gray-600">Fecha: {{ today | date:'mediumDate' }}</div>
      <div class="text-xs text-gray-600">Período: {{ (selectedPeriodLabel$ | async) }}</div>
      <div class="text-xs text-gray-600">Carrera: {{ (selectedCareerLabel$ | async) }}</div>
    </div>
    <hr class="my-3" />
  </div>
  <!-- Encabezado / Filtros -->
  <div class="bg-white border border-gray-200 rounded-xl shadow-sm p-4 no-print">
    <div class="flex items-center gap-4">
      <div class="text-sm font-semibold text-gray-700">Reportes del Administrador</div>
      <div class="ml-auto flex items-center gap-4">
        <div class="flex items-center gap-2">
          <label class="text-xs text-gray-500">Período</label>
          <select class="text-sm border rounded-md px-2 py-1" (change)="onChangePeriod($event)">
            <option [value]="''">Seleccione un período</option>
            <option *ngFor="let p of (periods$ | async)" [value]="p.id_academic_periods">{{ p.name }}</option>
          </select>
        </div>
        <div class="flex items-center gap-2">
          <label class="text-xs text-gray-500">Carrera</label>
          <select class="text-sm border rounded-md px-2 py-1" (change)="onChangeCareer($event)">
            <option [value]="''">Seleccione una carrera</option>
            <option *ngFor="let c of (careers$ | async)" [value]="c.id">{{ c.nombre }}</option>
          </select>
        </div>
        <button class="text-sm px-3 py-1.5 rounded-md border hover:bg-gray-50" (click)="onExportReport()">
          <i class="fa-solid fa-file-pdf mr-1 text-rose-600"></i> Exportar PDF
        </button>
      </div>
    </div>
  </div>

  <!-- Contenido exportable -->
  <div #printContent>
  <!-- KPIs -->
  <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
    <div class="bg-white border border-gray-200 rounded-xl p-4">
      <div class="text-xs text-gray-500">Total en proceso</div>
      <div class="text-2xl font-semibold text-gray-800">{{ (dash$ | async)?.totalEnProceso }}</div>
    </div>
    <div class="bg-white border border-gray-200 rounded-xl p-4">
      <div class="text-xs text-gray-500">UIC</div>
      <div class="text-2xl font-semibold text-gray-800">{{ (dash$ | async)?.uicPercent }}%</div>
    </div>
    <div class="bg-white border border-gray-200 rounded-xl p-4">
      <div class="text-xs text-gray-500">Examen Complexivo</div>
      <div class="text-2xl font-semibold text-gray-800">{{ (dash$ | async)?.complexivoPercent }}%</div>
    </div>
  </div>

  <!-- Listas -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
    <div class="bg-white border border-gray-200 rounded-xl shadow-sm print-card">
      <div class="px-5 py-3 border-b text-sm font-semibold text-gray-700">Estudiantes sin tutor</div>
      <div class="p-4">
        <ng-container *ngIf="(sinTutor$ | async) as items">
          <div *ngIf="items.length === 0" class="text-sm text-gray-500">No hay registros.</div>
          <ul *ngIf="items.length > 0" class="report-list">
            <li *ngFor="let it of items" class="row">
              <div>
                <div class="title">{{ it.fullname }}</div>
                <div class="subtitle" *ngIf="it.career_name">{{ it.career_name }}</div>
              </div>
              <div class="meta" *ngIf="it.suggested_tutor">Sugerido: {{ it.suggested_tutor }}</div>
            </li>
          </ul>
        </ng-container>
      </div>
    </div>

    <div class="bg-white border border-gray-200 rounded-xl shadow-sm print-card">
      <div class="px-5 py-3 border-b text-sm font-semibold text-gray-700">Estudiantes con tutor</div>
      <div class="p-4">
        <ng-container *ngIf="(conTutor$ | async) as items">
          <div *ngIf="items.length === 0" class="text-sm text-gray-500">No hay registros.</div>
          <ul *ngIf="items.length > 0" class="report-list">
            <li *ngFor="let it of items" class="row">
              <div>
                <div class="title">{{ it.fullname }}</div>
                <div class="subtitle" *ngIf="it.career_name">{{ it.career_name }}</div>
              </div>
              <div class="meta" *ngIf="it.tutor_name">Tutor: {{ it.tutor_name }}</div>
            </li>
          </ul>
        </ng-container>
      </div>
    </div>
  </div>
  </div>
</div>
