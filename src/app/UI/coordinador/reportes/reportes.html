<section class="space-y-6">
  <div>
    <h2 class="text-xl font-semibold text-gray-800">Reportes</h2>
    <div class="text-sm text-gray-500">Coordinador</div>
  </div>

  <div class="bg-white rounded-xl border border-gray-200 shadow-sm">
    <button type="button" class="w-full px-4 py-3 flex items-center justify-between" (click)="toggleGeneral()">
      <div class="text-sm font-semibold text-gray-800">Reporte General</div>
      <div class="text-xs text-gray-500">Filtros y previsualización</div>
    </button>

    <div class="px-4 pb-4" *ngIf="generalOpen">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
        <div>
          <label class="block text-sm text-gray-600 mb-1">Período académico</label>
          <select class="w-full border border-gray-300 rounded-md px-3 py-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
            [ngModel]="generalPeriodId" (ngModelChange)="generalPeriodId=$event">
            <option [ngValue]="null">Seleccione</option>
            <option *ngFor="let p of (periods$ | async)" [ngValue]="p.id">{{ p.name }}</option>
          </select>
        </div>

        <div>
          <label class="block text-sm text-gray-600 mb-1">Carrera</label>
          <select class="w-full border border-gray-300 rounded-md px-3 py-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
            [ngModel]="generalCareerId" (ngModelChange)="generalCareerId=$event">
            <option [ngValue]="null">Todas</option>
            <option *ngFor="let c of (careers$ | async)" [ngValue]="c.id">{{ c.nombre }}</option>
          </select>
        </div>

        <div class="flex items-end justify-end gap-2">
          <button type="button" (click)="limpiarGeneral()" class="px-3 py-2 rounded-lg border text-sm hover:bg-gray-50">
            Limpiar
          </button>
          <button type="button" (click)="previsualizarGeneral()" [disabled]="!generalPeriodId"
            class="px-3 py-2 rounded-lg border text-sm hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed">
            Previsualizar
          </button>
          <button type="button" (click)="generarPdfGeneral()" [disabled]="!previewGeneralInfo"
            class="px-3 py-2 rounded-lg bg-blue-600 text-white text-sm hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed">
            Generar PDF
          </button>
        </div>
      </div>

      <div class="mt-4">
        <div class="flex items-center justify-between mb-2">
          <div class="text-sm font-semibold text-gray-800">Previsualización</div>
          <div class="text-xs text-gray-500">Registros: {{ previewGeneral.length || 0 }}</div>
        </div>
        <div class="overflow-x-auto">
          <table class="min-w-full text-sm border border-gray-200 rounded-lg overflow-hidden table-auto">
            <thead class="bg-gray-50 sticky top-0 z-10">
              <tr class="text-gray-700 text-xs uppercase tracking-wider">
                <th class="px-3 py-2 text-center w-16">N°</th>
                <th class="px-3 py-2 text-left">Estudiante</th>
                <th class="px-3 py-2 text-left w-[35%]">Carrera</th>
                <th class="px-3 py-2 text-left w-[18%]">Modalidad</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-100">
              <tr *ngFor="let r of previewGeneral" class="odd:bg-white even:bg-gray-50 hover:bg-gray-100 transition-colors">
                <td class="px-3 py-2 text-center">{{ r.nro }}</td>
                <td class="px-3 py-2">{{ r.estudiante }}</td>
                <td class="px-3 py-2">{{ r.carrera }}</td>
                <td class="px-3 py-2">{{ r.modalidad }}</td>
              </tr>
              <tr *ngIf="!previewGeneral.length">
                <td colspan="4" class="px-3 py-6 text-center text-gray-500">Sin datos para mostrar</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <div class="bg-white rounded-xl border border-gray-200 shadow-sm">
    <button type="button" class="w-full px-4 py-3 flex items-center justify-between" (click)="toggleSpecific()">
      <div class="text-sm font-semibold text-gray-800">Reportes Específicos</div>
      <div class="text-xs text-gray-500">UIC / Examen Complexivo</div>
    </button>

    <div class="px-4 pb-4" *ngIf="specificOpen">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
        <div>
          <label class="block text-sm text-gray-600 mb-1">Período académico</label>
          <select class="w-full border border-gray-300 rounded-md px-3 py-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
            [ngModel]="specificPeriodId" (ngModelChange)="specificPeriodId=$event">
            <option [ngValue]="null">Seleccione</option>
            <option *ngFor="let p of (periods$ | async)" [ngValue]="p.id">{{ p.name }}</option>
          </select>
        </div>

        <div>
          <label class="block text-sm text-gray-600 mb-1">Carrera</label>
          <select class="w-full border border-gray-300 rounded-md px-3 py-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
            [ngModel]="specificCareerId" (ngModelChange)="specificCareerId=$event">
            <option [ngValue]="null">Todas</option>
            <option *ngFor="let c of (careers$ | async)" [ngValue]="c.id">{{ c.nombre }}</option>
          </select>
        </div>

        <div>
          <label class="block text-sm text-gray-600 mb-1">Modalidad</label>
          <select class="w-full border border-gray-300 rounded-md px-3 py-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
            [ngModel]="specificModalidad" (ngModelChange)="specificModalidad=$event">
            <option [ngValue]="''">Seleccione</option>
            <option [ngValue]="'UIC'">UIC</option>
            <option [ngValue]="'EXAMEN_COMPLEXIVO'">Examen Complexivo</option>
          </select>
        </div>
      </div>

      <div class="flex items-center justify-end gap-2 mt-3">
        <button type="button" (click)="limpiarSpecific()" class="px-3 py-2 rounded-lg border text-sm hover:bg-gray-50">
          Limpiar
        </button>
        <button type="button" (click)="previsualizarEspecifico()" [disabled]="!specificPeriodId || !specificModalidad"
          class="px-3 py-2 rounded-lg border text-sm hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed">
          Previsualizar
        </button>
        <button type="button" (click)="generarPdfEspecifico()" [disabled]="!previewEspecificoInfo"
          class="px-3 py-2 rounded-lg bg-blue-600 text-white text-sm hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed">
          Generar PDF
        </button>
      </div>

      <div class="mt-4">
        <div class="flex items-center justify-between mb-2">
          <div class="text-sm font-semibold text-gray-800">Previsualización</div>
          <div class="text-xs text-gray-500">Registros: {{ previewEspecifico.length || 0 }}</div>
        </div>
        <div class="overflow-x-auto">
          <table class="min-w-full text-sm border border-gray-200 rounded-lg overflow-hidden table-auto">
            <thead class="bg-gray-50 sticky top-0 z-10">
              <tr class="text-gray-700 text-xs uppercase tracking-wider">
                <th class="px-3 py-2 text-center w-16">N°</th>
                <th class="px-3 py-2 text-left">Estudiante</th>
                <th class="px-3 py-2 text-left" [ngClass]="specificModalidad==='UIC' ? 'w-[26%]' : 'w-[42%]'">Carrera</th>
                <th class="px-3 py-2 text-left w-[14%]">Modalidad</th>
                <th class="px-3 py-2 text-left w-[18%]" *ngIf="specificModalidad==='UIC'">Tutor</th>
                <th class="px-3 py-2 text-left w-[18%]" *ngIf="specificModalidad==='UIC'">Tribunal</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-100">
              <tr *ngFor="let r of previewEspecifico" class="odd:bg-white even:bg-gray-50 hover:bg-gray-100 transition-colors">
                <td class="px-3 py-2 text-center">{{ r.nro }}</td>
                <td class="px-3 py-2">{{ r.estudiante }}</td>
                <td class="px-3 py-2 whitespace-normal break-words">{{ r.carrera }}</td>
                <td class="px-3 py-2">{{ r.modalidad }}</td>
                <td class="px-3 py-2" *ngIf="specificModalidad==='UIC'">{{ r.tutor }}</td>
                <td class="px-3 py-2" *ngIf="specificModalidad==='UIC'">{{ r.tribunal }}</td>
              </tr>
              <tr *ngIf="!previewEspecifico.length">
                <td [attr.colspan]="specificModalidad==='UIC' ? 6 : 4" class="px-3 py-6 text-center text-gray-500">
                  Sin datos para mostrar
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</section>