<div class="space-y-4">
  <div class="bg-white rounded-xl border border-gray-200 shadow-sm p-4">
    <div class="flex items-center justify-between">
      <div>
        <div class="text-base font-semibold text-gray-800">Reportes - Vicerrectorado</div>
        <div class="text-xs text-gray-500">Examen Complexivo</div>
      </div>
      <button class="text-xs px-3 py-1.5 rounded border" (click)="toggleFilters()">
        {{ filtersOpen ? 'Ocultar filtros' : 'Mostrar filtros' }}
      </button>
    </div>

    <div *ngIf="filtersOpen" class="mt-4 grid grid-cols-1 md:grid-cols-3 gap-3">
      <div>
        <label class="block text-xs text-gray-500 mb-1">Período</label>
        <select class="w-full text-sm border rounded-md px-3 py-2" [(ngModel)]="selectedPeriodId">
          <option [ngValue]="null">Seleccione un período</option>
          <option *ngFor="let p of (periods$ | async)" [ngValue]="p.id">{{ p.name }}</option>
        </select>
      </div>
      <div>
        <label class="block text-xs text-gray-500 mb-1">Carrera</label>
        <select class="w-full text-sm border rounded-md px-3 py-2" [(ngModel)]="selectedCareerId">
          <option [ngValue]="null">Todas</option>
          <option *ngFor="let c of (careers$ | async)" [ngValue]="c.id">{{ c.nombre }}</option>
        </select>
      </div>
      <div>
        <label class="block text-xs text-gray-500 mb-1">Tipo de reporte</label>
        <select class="w-full text-sm border rounded-md px-3 py-2" [(ngModel)]="reportType">
          <option value="">Seleccione</option>
          <option value="MATERIAS">Materias asignadas para complexivo</option>
          <option value="DOCENTES">Docentes asignados a complexivo</option>
        </select>
      </div>
    </div>

    <div class="mt-4 flex flex-wrap justify-end gap-2">
      <button class="text-xs px-3 py-1.5 rounded border" (click)="limpiar()">Limpiar</button>
      <button class="text-xs px-3 py-1.5 rounded-md bg-slate-700 text-white hover:bg-slate-800"
        (click)="previsualizar()">Previsualizar</button>
      <button class="text-xs px-3 py-1.5 rounded-md bg-indigo-600 text-white hover:bg-indigo-700"
        (click)="generarPdf()">Generar PDF</button>
    </div>
  </div>

  <div *ngIf="previewInfo" class="bg-white rounded-xl border border-gray-200 shadow-sm p-4">
    <div class="text-sm font-semibold text-gray-800">Previsualización</div>
    <div class="text-xs text-gray-500 mt-1">
      Período: <strong>{{ previewInfo.periodLabel }}</strong>
      <span class="mx-2">|</span>
      Carrera: <strong>{{ previewInfo.careerLabel }}</strong>
    </div>

    <div class="mt-4 overflow-x-auto" *ngIf="reportType==='MATERIAS'">
      <table class="min-w-full text-sm">
        <thead class="bg-gray-50 text-gray-700 text-xs uppercase">
          <tr>
            <th class="px-3 py-2 text-left">N°</th>
            <th class="px-3 py-2 text-left">Materias</th>
            <th class="px-3 py-2 text-left">Carrera</th>
            <th class="px-3 py-2 text-left">Estado</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-gray-100">
          <tr *ngFor="let r of previewMaterias">
            <td class="px-3 py-2">{{ r.nro }}</td>
            <td class="px-3 py-2">{{ r.materia }}</td>
            <td class="px-3 py-2">{{ r.carrera }}</td>
            <td class="px-3 py-2">{{ r.estado }}</td>
          </tr>
          <tr *ngIf="!previewMaterias.length">
            <td class="px-3 py-3 text-center text-gray-500" colspan="4">Sin registros</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="mt-4 overflow-x-auto" *ngIf="reportType==='DOCENTES'">
      <table class="min-w-full text-sm">
        <thead class="bg-gray-50 text-gray-700 text-xs uppercase">
          <tr>
            <th class="px-3 py-2 text-left">N°</th>
            <th class="px-3 py-2 text-left">Docente</th>
            <th class="px-3 py-2 text-left">Materia</th>
            <th class="px-3 py-2 text-left">Carrera</th>
            <th class="px-3 py-2 text-left">Estado</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-gray-100">
          <tr *ngFor="let r of previewDocentes">
            <td class="px-3 py-2">{{ r.nro }}</td>
            <td class="px-3 py-2">{{ r.docente }}</td>
            <td class="px-3 py-2">{{ r.materia }}</td>
            <td class="px-3 py-2">{{ r.carrera }}</td>
            <td class="px-3 py-2">{{ r.estado }}</td>
          </tr>
          <tr *ngIf="!previewDocentes.length">
            <td class="px-3 py-3 text-center text-gray-500" colspan="5">Sin registros</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>